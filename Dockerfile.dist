### NPM PUBLISH ###

# NOTE:
# Used to publish the Pepr dist to the npm registry
# In this file, we keep the *.ts intentionally
# Any other changes to Dockerfile should be reflected in Publish

# crane digest cgr.dev/chainguard/node-lts:latest-dev
FROM cgr.dev/chainguard/node-lts@sha256:4db5b44244c45471ae6d94e54a048e28f670d20d2657e32673fd1445df4b2edc AS build

WORKDIR /app

COPY --chown=node:node . .

RUN npm ci

RUN npm run build 


FROM scratch AS dist

COPY --from=build /app/dist ./dist/
