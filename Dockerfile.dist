### NPM PUBLISH ###

# NOTE:
# Used to publish the Pepr dist to the npm registry
# In this file, we keep the *.ts intentionally
# Any other changes to Dockerfile should be reflected in Publish

# crane digest cgr.dev/chainguard/node-lts:latest-dev
FROM cgr.dev/chainguard/node-lts@sha256:d38ff06dccf8fed3752836ae72a8b10bf9862c9cb297efb48c94c419c87fbe6c AS build

WORKDIR /app

COPY --chown=node:node . .

RUN npm ci

RUN npm run build 


FROM scratch AS dist

COPY --from=build /app/dist ./dist/
